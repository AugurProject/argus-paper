%
% File ACL2016.tex
%

\documentclass[11pt]{article}
\usepackage[utf8]{inputenc}
\usepackage{acl2016}
\usepackage{times}
\usepackage{latexsym}
\usepackage{amsfonts}
\usepackage{url}

\aclfinalcopy % Uncomment this line for the final submission
%\def\aclpaperid{***} %  Enter the acl Paper ID here

% To expand the titlebox for more authors, uncomment
% below and set accordingly.
% \addtolength\titlebox{.5in}    

\newcommand\BibTeX{B{\sc ib}\TeX}


\title{Joint Learning of Sentence Embeddings for Relevance and Entailment}

% Author information can be set in various styles:
% For several authors from the same institution:
% \author{Author 1 \and ... \and Author n \\
%         Address line \\ ... \\ Address line}
% if the names do not fit well on one line use
%         Author 1 \\ {\bf Author 2} \\ ... \\ {\bf Author n} \\
% For authors from different institutions:
% \author{Author 1 \\ Address line \\  ... \\ Address line
%         \And  ... \And
%         Author n \\ Address line \\ ... \\ Address line}
% To start a seperate ``row'' of authors use \AND, as in
% \author{Author 1 \\ Address line \\  ... \\ Address line
%         \AND
%         Author 2 \\ Address line \\ ... \\ Address line \And
%         Author 3 \\ Address line \\ ... \\ Address line}
% If the title and author information does not fit in the area allocated,
% place \setlength\titlebox{<new height>} right after
% at the top, where <new height> can be something larger than 2.25in
\author{Petr Baudi\v{s},
	Silvestr Stanko \and
	Jan \v{S}ediv\'{y} \\
	FEE CTU Prague\\
	Department of Cybernetics\\
	Technick\'{a} 2, Prague,\\Czech Republic\\
	{\tt baudipet@fel.cvut.cz}}

%\author{Author 1\\
%	    XYZ Company\\
%	    111 Anywhere Street\\
%	    Mytown, NY 10000, USA\\
%	    {\tt author1@xyz.org}
%	  \And
%	Author 2\\
%  	ABC University\\
%  	900 Main Street\\
%  	Ourcity, PQ, Canada A1A 1T2\\
%  {\tt author2@abc.ca}}

\date{}

\begin{document}

\maketitle

\begin{abstract}
	We consider the problem of Recognizing Textual Entailment
	within an Information Retrieval context, where we must simultaneously
	determine the relevancy as well as degree of entailment for individual
	pieces of evidence to determine a yes/no answer to a binary
	natural language question.

	We compare several neural network variants for sentence embeddings
	in a setting of decision-making based on evidence of varying relevance.
	We propose a basic model to integrate evidence for entailment,
	show that joint training of the sentence embeddings to model
	relevance and entailment is feasible and that our proposed model
	is powerful enough to correctly answer most questions even when
	given a relatively small dataset and no explicit per-evidence supervision.
	% even in the context of strong non-neural IR baselines.

	Our research is motivated primarily by a new open dataset we introduce,
	consisting of binary questions and news-based evidence snippets.
	We also apply the proposed relevance-entailment model on a similar task
	of ranking multiple-choice test answers, evaluating it on the standard
	MCTest dataset and another preliminary dataset of school test questions.
\end{abstract}

\section{Introduction}

Let us consider the goal of building machine reasoning systems based
on knowledge from fulltext data like encyclopedic articles, scientific
papers or news articles.
Such machine reasoning systems, like humans researching a problem,
must be able to retrieve evidence from large amounts of retrieved
but irrelevant information and judge what answer the evidence entails
to the question at hand.

A typical approach, used implicitly in information retrieval
(and its extensions, like IR-based Question Answering systems \cite{YodaQAPoster2015}),
is to determine evidence relevancy by a keyword overlap feature (like tf-idf or BM-25 \cite{BM25})
and prune the evidence by the relevancy score.
On the other hand, textual entialment systems that seek to confirm hypotheses
based on evidence \cite{RTE1} \cite{SICK2014} \cite{SNLI}
are typically provided with only a single piece of evidence
or only evidence pre-determined as relevant, and are often restricted
to short and simple sentences without open-domain named entity occurences.

In this work, we seek to fuse information retrieval and textual entaiment
recognition by defining the \textbf{Argus Yes/No Question Answering} task.
The problem is, given a real-world event binary question like
\textit{Did Donald Trump announce he is running for president?}
and numerous retrieved news article fragments as evidence,
to determine the answer for the question.

This problem is motivated by the Argus automatic reporting system for
the Augur prediction market paltform. \cite{argus}  Therefore, we consider the question answering task
within the constraints of a practical task that has limited available dataset
and only minimum supervision.  Hence, the evidence are authentic news
sentences (with noise like segmentation errors, irrelevant participial phrases, etc.),
and whereas we have gold standard for
the correct answers, the model must do without explicit supervision on
which individual evidence snippets are relevant and what do they entail.

To this end, we introduce an open dataset of questions and newspaper evidence,
and a neural model within the Sentence Pair Scoring framework \cite{sps}
that (A) learns sentence embeddings for the question and evidence,
(B) the embeddings represent both relevance and entailment characteristics
as linear classifier inputs, and (C) the model aggregates all available evidence
to produce a binary signal as the answer, which is the only training supervision.

A related task concerns ranking answers of multiple-choice questions given
a set of evidencing sentences.  We evaluate our model on this task as well,
considering the MCTest dataset and the AI2-8grade/CK12 dataset that we introduce
below.

The paper is structured as follows.  In Sec.~\ref{sec:argus}, we formally outline
the Argus question answering task, describe the question-evidence dataset,
and describe the multiple-choice questions task and datasets.
In Sec.~\ref{sec:relwork}, we briefly survey the related work on similar problems,
whereas in Sec.~\ref{sec:clasrel} we present our ClasRel neural model for joint
learning of sentence relevance and entailment.  We present the results in Sec.~\ref{sec:res}
and conclude with a summary and future work directions in Sec.~\ref{sec:concl}.

\section{The Argus Task}
\label{sec:argus}

We propose a solution to the Argus Task, where
the \textbf{Argus} system \cite{arguswp} \cite{argus}
is to automatically analyze and answer questions
in the context of the \textbf{Augur} prediction market platform.%
\footnote{\url{https://augur.net/}}
In a prediction market, some users pose questions about the future
whereas other users bet on the \textit{yes} or \textit{no} answer,
with the assumption that the bet price reflects the real probability
of the event.  At a specified moment (e.g.\ after the date of a to-be-predicted sports match), the
correct answer is retroactively determined and the bets are paid off.
At a larger volume of questions, determining the bet results may
present a significant overhead for running of the market.
This motivates the Argus system, which should partially automate
this determination --- deciding questions related to recent events
based on open news sources.

Formally, the Argus task is to build a function $y_i = f_h(H_i)$,
where $y_i \in [0,1]$ is a binary label (\textit{no} towards \textit{yes})
and $H_i = (q_i, M_i)$ is a hypothesis in the form of question text $q_i$
and a set of $M_i = \{m_{ij}\}$ memory texts $m_{ij}$ as extracted
from an evidence-carrying corpus.

TODO: example


\subsection{Argus Dataset}

To help develop a machine learning model for the $f_h$ function,
we have created a dataset of questions with gold labels, and used
this dataset with an IR information retrieval component of the Argus
system to generate memory texts from a variety of news papers.
We release this dataset openly.%
\footnote{\url{https://github.com/brmson/dataset-sts} directory data/hypev/argus}

To pose a reproducible task for the IR component, the time domain
of questions was restricted from September 1, 2014 to September 1, 2015,
and topic domain was focused to politics, sports and the stock market.
To build the question dataset, we have used several sources:
\begin{itemize}
	\item We asked Amazon Mechanical Turk users to pose questions, together with a golden label and a news article reference.
		This seeded the dataset with initial, somewhat repetitive 250 questions.
	\item We manually extended this dataset by derived questions with reversed polarity (to obtain an opposite answer).
	\item We extended the data with questions autogenerated from templates, pertaining top sporting event winners and US senate or gubernatorial elections.
\end{itemize}

To build the memories dataset, we used the \textbf{Syphon} component
\cite{argus}
of the stock Argus implementation%
\footnote{\url{https://github.com/AugurProject/argus}}
to identify semantic roles of all question tokens and produce
the search keywords if a role was assigned to each token.
We then used the stock IR component to query a corpus of newspaper
articles, and kept sentences that contained at least 2/3 of all
the keywords.
Our corpus of articles contained articles from The Guardian (all articles) and from the New York Times (Sports, Politics and Business sections).  Furthermore, we scraped partial archive.org historical data out of 35 RSS feeds from CNN, Reuters, BBC International, CBS News, ABC News, c|net, Financial Times, Skynews and the Washington Post.

For the final dataset, we kept only questions where at least
a single memory was found (i.e.\ we successfuly assigned a role
to each token, found some news stories and found at least one
sentence with 2/3 of question keywords within).  The final size
of the dataset is outlined in Fig.~\ref{tab:dataset}.

\begin{figure}
	\centering
	\begin{tabular}{|c|ccc|}
		\hline
		& Train & Val. & Test \\
		\hline
		Original $\#q$ & 1829 & 303 & 295 \\
		Post-search $\#q$ & 1081 & 167 & 158 \\
		Average $\#m$ per q. & 19.04 & 13.99 & 16.66 \\
		\hline
	\end{tabular}
	\vspace*{-0.2cm}
	\caption{\footnotesize%
		Characteristics of the Argus QA dataset.
	}
	\label{tab:dataset}
\end{figure}


\subsection{MCTest Dataset}

The \textbf{Machine Comprehension Test} \cite{MCTest} dataset has been introduced
to provide a challenge for researchers to come up with models that approach
human-level reading comprehension, and serve as a higher-level alternative
to semantic parsing tasks that enforce a specific knowledge representation.
The dataset consists of a set of 660 stories spanning
multiple sentences, written in simple and clean language (but with less restricted
vocabulary than e.g.\ the bAbI dataset \cite{bAbI}).  Each story is accompanied
by four questions, each with four possible answers; the questions are tagged
as based on just a single in-story sentence, or requiring multiple sentence inference.
We use an official extension of the dataset for RTE evaluation
that replaces answers by full statements that combine each answer with the question.

The dataset is split in two parts, MC-160 and MC-500, based on provenance but
similar in quality.
We report performance on both parts separately to be comparable with earlier
work, as well as on a joined version MC-660 in order to increase evaluation
accuracy.  We always train the model on the joined version training set.

The practical setting differs from the Argus task as the MCTest dataset contains
relatively restricted vocabulary and well-formed sentences; furthermore,
the goal is to find the single key point in the story to focus on, while
in our setting we may have many pieces of evidence supporting an answer.


\subsection{AI2-8grade/CK12 Dataset}

The \textbf{AI2 Elementary School Science Questions} (no-diagrams variant)%
\footnote{http://allenai.org/data.html} released by the Allen Institute
cover 855 basic four-choice questions regarding high school science
and follows up to the Allen AI Science Kaggle challenge.%
\footnote{https://www.kaggle.com/c/the-allen-ai-science-challenge}
The vocabulary includes scientific jargon and named entities, and many questions
are not factoid, requiring real-world reasoning or thought experiments.

We have combined each answer with the respective question (crudely by
substituting wh-word in the question with the answer) and retrieved
evidence sentences for each hypothesis using Solr search in a collection
of CK-12 ``Concepts B'' textbooks.%
\footnote{We have also tried, but the dataset is much harder.}
525 questions attained any supporting evidence.

We consider this dataset as preliminary, because it was not reviewed
by a human and many hypotheses are apparently unprovable by the evidence
we have gathered.


\section{Related Work}
\label{sec:relwork}

Our primary concern when integrating natural language query and
textual evidence is to build sentence-level representations that
can be used both for relevance weighing and answer prediction.

Sentence-level representations in the retrieval + inference context have been
popularly proposed within the Memory Network framework \cite{MemNN},
but just averaged word embeddings are explored; the task includes
only very simple sentences and a small vocabulary.
Much more realistic setting is introduced in the Answer Sentence Selection
context \cite{AnsselWang} \cite{sps}, with state-of-art models using complex
deep neural architectures with attention \cite{attnpooling}, but ths selection
task consists of only retrieval and no inference (answer prediction).
A more indirect retrieval task regarding news summarization was investigated
by \cite{AttSum}.

In the entailment context, \cite{SNLI} introduced a large dataset
with single-evidence sentence pairs (Stanford Natural Language Inference, SNLI),
but a larger vocabulary and
slightly more complicated (but still conservatively formed) sentences
They also proposed baseline recurrent neural model for modeling
sentence representations, while word-level attention based models
are studied more recently \cite{SNLIattn} \cite{LSTMMR}.

TODO SICK-2014

In the MCTest text comprehension challenge \cite{MCTest}, the
best models use complex feature engineering ensembling multiple traditional
semantic NLP approaches, while the best deep model so far
of \cite{HABCNN} uses convolutional neural networks to build sentence
representations, and attention on multiple levels to select evidencing
sentences.

\section{ClasRel Neural Model}
\label{sec:clasrel}

Our approach is to use a sequence of word embeddings to build
sentence embeddings for each hypothesis and respective evidence,
then use the sentence embeddings to estimate relevance and
entailment of each evidence with regard to the respective
hypothesis, and integrate the evidence by weighing the entailment
by relevance.

\subsection{Sentence Embeddings}

To produce sentence embeddings, we investigated the usage
of neural models of the \texttt{dataset-sts} framework
for deep learning of sentence pair scoring functions. \cite{sps}

We refer the reader to \cite{sps} and its references for detailed
model descriptions.  We evaluate an RNN model which uses bidirectionally
summed GRU memory cells and uses the final states as embeddings;
a CNN model which uses sentence-max-pooled filters as embeddings;
a RNN-CNN model which puts the CNN on top of per-token GRU outputs
rather than the word embeddings; and an \textit{attn1511} model
inspired by \cite{attn1511} that integrates the RNN-CNN model
with per-word softmax attention to focus evidence embeddings based
on the hypothesis.

As model input, we use the standard GloVe embeddings \cite{GloVe}.
Relative to \cite{sps}, we introduce two differences to the word
embedding --- we use 50-dimensional embeddings instead of 300-dimensional
and rather than building an adaptable embedding matrix only from the
training set words preinitialized by GloVe, we use only the top 100
most frequent tokens in the adaptable embedding matrix and use
fixed GloVe vectors for all other tokens (including tokens not
found in the training set).  This should improve behavior for highly
vocabulary-rich tasks like Argus, while still allowing the high-frequency
tokens (like interpunction or conjunctions) to learn semantic operator representations.

\subsection{Evidence Integration}

From each pair of hypothesis and evidence embeddings, we produce two $[0,1]$
predictions using a pair of MLP point-scorers of \texttt{dataset-sts} \cite{sps}%
\footnote{From the elementwise product
and sum of the embeddings, a linear classifier directly produces a prediction;
contrary to typical setup, we use no hidden layer.}
with sigmoid activation function.  The predictions are interpreted as $C_i \in [0,1]$
entailment (0 to 1 as \textit{no} to \textit{yes}) and relevance $R_i \in [0,1]$.

To integrate the predictions across multiple pieces of evidence,
we propose a weighed average model:\\

\[ y  = \dfrac{\sum_i C_iR_i}{\sum_i R_i}
\]

We do not have access to any explicit labels for the evidence,
but we train the model end-to-end with just $y$ labels and the formula
for $y$ is differentiable, carrying over the gradient to the sentence
embedding model.

\section{Results}
\label{sec:res}

\subsection{Experimental Setup}

We train the whole model from word embeddings to output evidence-integrated
hypothesis label using the binary cross-entropy loss as an objective
and the Adam optimization algorithm.

\subsection{Evaluation}

Rnn features only:
Train: 0.936168 ±0.014544
Val: 0.883608 ±0.008952
Test: 0.829114 ±0.011312

Avg features only:
Train: 0.917400 ±0.003061
Val: 0.768713 ±0.009674
Test: 0.678006 ±0.009330

cnn features only:
Train: 0.959917 ±0.009605
Val: 0.880988 ±0.014256
Test: 0.821994 ±0.020737

attn1511 features only:
Train: 0.936399 ±0.011737
Val: 0.899701 ±0.008580
Test: 0.854430 ±0.009165

Average end-to-end: argus tests, commit 0addc0d - 3d input, na konci mean
classification (uniform relevance), classification by rnn:
Train: 0.730074 ±0.008370
Val: 0.729042 ±0.006503
Test: 0.674842 ±0.012944

relevance by BM25:
TODO

\subsection{Embeddings Analysis}

\section{Conclusion}
\label{sec:concl}

We release our implementation of the Argus task, evidence integration
model and dataset processing as open source.%
\footnote{\url{https://github.com/brmson/dataset-sts} task \textit{hypev}}


\section*{Acknowledgments}
{\footnotesize
	This work was co-funded by the Augur Project of the Forecast Foundation
and financially supported by the Grant Agency of the Czech Technical
University in Prague, grant No. SGS16/ 084/OHK3/1T/13.
Computational resources were provided by the CESNET LM2015042 and the CERIT Scientific Cloud LM2015085,
provided under the programme ``Projects of Large Research, Development, and Innovations Infrastructures.''

We'd like to thank Peronet Despeignes of the Augur Project for his support.
Carl Burke has provided instructions for searching CK-12 ebooks within
the Kaggle challenge.}

\bibliography{qa,sps,argus}
\bibliographystyle{acl2016}

\end{document}
